<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sign Up | Content Hub</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/main.css">
  <script defer src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js"></script>

  <script defer src="https://rw-501.github.io/contenthub/js/auth.js"></script>

  <script type="module" src="https://rw-501.github.io/contenthub/js/firebase-config.js" defer></script>

    <!-- Add this to your <head> -->
  <link rel="stylesheet" href="https://rw-501.github.io/contenthub/css/main.css">

  <style>
    body { background: #f5f5f5; }
    .auth-box {
      max-width: 450px;
      margin: auto;
      margin-top: 60px;
      background: white;
      border-radius: 10px;
      padding: 30px;
      box-shadow: 0 0 20px rgba(0,0,0,0.05);
    }
  </style>
</head>
<body>

<div class="auth-box">
  <h2 class="text-center mb-4">Join Content Hub</h2>

  <!-- Email Signup -->
  <div class="mb-3">
    <label for="email" class="form-label">Email address</label>
    <input type="email" class="form-control" id="email">
  </div>
  <div class="mb-3">
    <label for="password" class="form-label">Password</label>
    <input type="password" class="form-control" id="password">
  </div>
  <button class="btn btn-success w-100 mb-3" id="emailSignUpBtn">Sign Up with Email</button>

  <hr>

  <!-- Google Sign In -->
  <button class="btn btn-outline-dark w-100 mb-3" id="googleSignInBtn">Sign In with Google</button>

  <!-- Phone Auth -->
  <div class="mb-3">
    <label for="phoneNumber" class="form-label">Phone Number</label>
    <input type="text" class="form-control" id="phoneNumber" placeholder="+1234567890">
    <div id="recaptcha-container" class="mt-2"></div>
    <button class="btn btn-outline-primary w-100 mt-2" id="sendCodeBtn">Send OTP</button>
  </div>

  <div class="mb-3 d-none" id="otpSection">
    <label for="otpCode" class="form-label">Enter OTP</label>
    <input type="text" class="form-control" id="otpCode">
    <button class="btn btn-primary w-100 mt-2" id="verifyOtpBtn">Verify Code</button>
  </div>

  <p class="text-center mt-4">
    Already have an account? <a href="/pages/login.html">Login</a>
  </p>
</div>


<!-- Add this at the bottom of <body> -->
<div id="footerContainer"></div>

<script type="module">
  const footer = await fetch('https://rw-501.github.io/contenthub/includes/footer.html').then(res => res.text());
  document.getElementById('footerContainer').innerHTML = footer;
  import('https://rw-501.github.io/contenthub/includes/footer.js');
</script>


<script>
  document.addEventListener("DOMContentLoaded", () => {
    window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', {
      size: 'invisible',
      callback: () => {
        // Ready to send code
      }
    });
    recaptchaVerifier.render();
  });
</script>

<script>
  // Email/Password signup
  document.getElementById("emailSignUpBtn").addEventListener("click", async () => {
    const email = emailInput.value.trim();
    const password = passwordInput.value.trim();
    try {
      const userCredential = await firebase.auth().createUserWithEmailAndPassword(email, password);
      alert("Signed up successfully!");
      window.location.href = "/pages/profile.html";
    } catch (error) {
      alert(error.message);
    }
  });

  // Google login
  document.getElementById("googleSignInBtn").addEventListener("click", async () => {
    const provider = new firebase.auth.GoogleAuthProvider();
    try {
      await firebase.auth().signInWithPopup(provider);
      window.location.href = "/pages/profile.html";
    } catch (error) {
      alert(error.message);
    }
  });

  // Phone Auth
  let confirmationResult;
  document.getElementById("sendCodeBtn").addEventListener("click", async () => {
    const phone = document.getElementById("phoneNumber").value;
    try {
      confirmationResult = await firebase.auth().signInWithPhoneNumber(phone, window.recaptchaVerifier);
      document.getElementById("otpSection").classList.remove("d-none");
      alert("OTP sent!");
    } catch (error) {
      alert(error.message);
    }
  });

  document.getElementById("verifyOtpBtn").addEventListener("click", async () => {
    const code = document.getElementById("otpCode").value;
    try {
      await confirmationResult.confirm(code);
      alert("Phone number verified!");
      window.location.href = "/pages/profile.html";
    } catch (error) {
      alert("Invalid OTP: " + error.message);
    }
  });
</script>

</body>
</html>
